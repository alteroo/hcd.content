<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="hcd.content">
<body>


<metal:content-core fill-slot="content-core">
<metal:content-core define-macro="content-core"
                    tal:define="toc context/table_of_contents|nothing;">


<h1>Climate listing view</h1>

<div tal:define="events view/getEventList" class="row">
<div class="col-sm-4">
  <p class="col-sm-12"> 
    <input type="checkbox" name="click_all" id="click_all" value="all" />
    <span>全選/全不選</span>
  </p>

  <p class="col-sm-6 col-xs-4">
    <input type="checkbox" name="click_group_1" id="click_group_1" value="click_group_1" class='click_group'/>
    <span>氣象</span>
  </p>
  <p class="col-sm-6 col-xs-4">
    <input type="checkbox" name="click_group_2" id="click_group_2" value="click_group_2" class='click_group'/>
    <span>災害</span>
  </p>
  <p class="col-sm-6 col-xs-4">
    <input type="checkbox" name="click_group_3" id="click_group_3" value="click_group_3" class='click_group'/>
    <span>特殊現象</span>
  </p>
  <p class="col-sm-6 col-xs-4">
    <input type="checkbox" name="click_group_4" id="click_group_4" value="click_group_4" class='click_group'/>
    <span>其他</span>
  </p>

<div style="padding-top:150px">
  <p tal:repeat="event events" class="col-sm-6 col-xs-4">
    <input type="checkbox" name="event"
           tal:define="value python:event.split(':')[0];
                       group python:'group_1' if int(value) < 30 else 'group_2' if int(value) < 50 else 'group_3' if int(value) < 95 else 'group_4'"
           tal:attributes="value value;
                           class python:'event %s' % group"/>
    <span tal:content="python:event.split(':')[1]" />
  </p>
</div>
</div>

<div class="col-sm-8">
    <div class="result">Result</div>
</div>


</div>



<script>

// select all , cancle
$("#click_all").click(function() {
   if($("#click_all").prop("checked")) {
     $("input[name='event']").prop("checked", true);
     $("input[class='click_group']").prop("checked", true);
   } else {
     $("input[name='event']").prop("checked", false);
     $("input[class='click_group']").prop("checked", false);
   }
});

// select group_1 and cancle
$(".click_group").click(function() {
   var tag_id = this.id;
   if($("#" + tag_id).prop("checked")) {
     $("input[class='event group_" + tag_id.substr(-1) + "']").prop("checked", true);
   } else {
     $("input[class='event group_" + tag_id.substr(-1) + "']").prop("checked", false);
     $("input[name='click_all']").prop("checked", false);
   }
});

// when checkbox checked.
$(':checkbox').change(function() {
    var event = $("input.event:checked");
    var para = '';
    for(var i=0; i<event.length; i++) {
        para += "para:list=" + event[i].value + "&";
    };
    console.log(para);
    $("div.result").load("./@@get_climate?" + para);
});


</script>

</metal:content-core>
</metal:content-core>

</body>
</html>

